# CentOS 7 Linux_4_6

## 4. 서버를 구축할 때 알아야 할 필수 개념과 명령어

### 4.6 파이프, 필터, 리다이렉션

#### 파이프(pipe)

* 2개의 프로그램을 연결해주는 연결 통로를 의미

* `|`를 사용함.(`shift` + `\`)

* 사용 예

  ```bash
  $ ls -l /etc | more		# 'ls -l /etc'를 입력하면 파일이 너무 많아서, 1페이지에 모두 담을 수 없으므로 1페이지씩 나눠서 보겠다는 의미
  ```

  

#### 필터(filter)

* 필요한 것만 걸러주는 명령어

* `grep`, `tail`, `wc`, `sort`, `awk`, `sed` 명령어 등이 있다.

* 주로 파이프와 같이 사용한다.

* 사용 예

  ```bash
  $ ps -ef | grep bash	# 'ps -ef'를 입력하면 모든 프로세스 번호를 출력하므로, bash라는 글자가 들어간 프로세스만 출력하게 된다.
  $ rpm -qa | grep yum	# 설치된 패키지 중에서 'yum'이라는 글자가 들어간 패키지를 출력
  ```

  

#### 리다이렉션(redirection)

* 표준 입출력의 방향을 바꿔준다.

* 표준 입출력은 키보드, 표준 출력은 모니터이지만 이를 파일로 처리하고 싶을 때 주로 사용

* 사용 예

  ```bash
  $ ls -l > list.txt			# 'ls -l'의 결과를 list.txt 파일에 저장한다. list.txt 파일이 기존에 있으면 덮어쓴다. (overwrite)
  $ ls -l >> list.txt			# 위와 같지만, list.txt 파일이 기존에 있으면 기존의 내용에 이어서 쓴다. (append)
  $ sort < list.txt			# list.txt 파일을 정렬해서 화면에 출력
  $ sort < list.txt > out.txt	# list.txt 파일을 정렬해서 out.txt 파일에 쓴다.
  ```

  

### 4.7 프로세스, 데몬, 서비스

#### 프로세스(process)

하드디스크에 저장된 실행 코드(프로그램)가, 메모리에 로딩되어 활성화 된 것



##### 포그라운드 프로세스(Foreground Process)

* Firefox 등과 같이 실행하면 화면에 나타나서 사용자와 상호작용을 하는 프로세스를 말한다.
* 화면에서 실행되는 것이 보이는 프로세스



##### 백그라운드 프로세스(Background Process)

* 실행은 되었지만, 화면에는 나타나지 않고 뒤에서 실행되는 프로세스
* ex) 바이러스 백신, 서버 데몬 등
* 눈에는 보이지 않지만 실행되는 것



##### 프로세스 번호

* 메모리에 로딩되어 활성화된 프로세스를 구분하려면 각각의 고유 번호가 필요
* 각각의 프로세서에 할당된 고유 번호를 프로세스 번호라 부른다.
* 메모리에서 활성화된 프로세스를 메모리에서 강제로 제거하려면 프로세스 번호를 사용



##### 작업 번호

* 현재 실행되는 백그라운드 프로세스의 순차 번호



##### 부모 프로세스와 자식 프로세스

* 모든 프로세스는 혼자서 독립적으로 실행되는 것이 아니라, 부모 프로세스의 하위에 종속되어 실행
* 부모 프로세스를 종료하면 그에 종속된 자식 프로세스도 모두 종료된다.



##### 프로세스 관련 주요 명령어

* ps

  * 현재 프로세스의 상태를 확인하는 명령어

  * 많은 옵션과 함께 사용될 수 있다.

    ```bash
    $ ps -ef | grep 프로세스이름
    ```

* kill

  * 프로세스를 강제로 종료하는 명령어

  * `-9` 옵션과 함께 사용하면 무조건 프로세스가 종료된다. (강제 종료)

    ```bash
    $ kill -9 프로세스번호
    ```

* pstree

  * 부모 프로세스와 자식 프로세스의 관계를 트리 형태로 보여준다.



#### 서비스(service)

* 데몬(deamon)이라고도 부르며, 서버 프로세스를 말한다.
* 서비스는 웹 서버, 네임 서버, DB 서버 등의 프로세스를 지칭한다.
* 웹 서버 데몬, 네임 서버 데몬 등으로 부르기도 한다.
* 서비스는 눈에 보이지 않지만, 현재 시스템에서 동작 중인 프로세스이므로 백그라운드 프로세스의 일종이라고 할 수 있다.



### 4.8 서비스와 소켓

서비스 : 평상시에도 늘 가동하는 서버 프로세스

소켓(Socket) : 필요할 때만 작동하는 서버 프로세스

서비스와 소켓은 `systemd`라고 부르는 서비스 매니저 프로그램으로 작동시키거나 관리한다.



#### 서비스

* 시스템과 독자적으로 구동되어 제공하는 프로세스
  * ex) 웹 서버(httpd), DB 서버(mysqld), FTP 서버(vsftpd) 등
* 실행 및 종료는 대개 `systemctl start/stop/restart 서비스이름`으로 사용
* 서비스의 실행 스크립트 파일은 `/usr/lib/systemd/system/` 디렉터리에 `서비스이름.service`라는 이름으로 확인 가능
* 부팅과 동시에 서비스의 자동 실행 여부를 지정할 수 있다.
* `systemctl list-unit-files`를 실행하면 현재 사용과 사용 안 함을 확인할 수 있다.



#### 소켓

* 서비스는 항상 가동되지만, 소켓은 외부에서 특정 서비스를 요청할 경우에 systemd가 구동시킨다. 요청이 끝나면 소켓도 종료된다.
* ex) 텔넷 서버
* 소켓과 관련된 스크립트 파일은 `/usr/lib/systemd/system/` 디렉터리에 `소켓이름.socket` 이라는 이름으로 존재

